#!perl -w    # -*- cperl; cperl-indent-level: 4 -*-
use strict;
use warnings;

use 5.014000;
use utf8;

our $VERSION = '0.100';

# Copyright 2013 Roland van Ipenburg

use Encode qw(decode_utf8);
use HTML::Hyphenate;

use File::Slurp qw(read_file);
use Readonly;
Readonly::Scalar my $EMPTY      => q{};
Readonly::Scalar my $MIN_LENGTH => 5;

my $hyphenator = HTML::Hyphenate->new();
$hyphenator->min_length($MIN_LENGTH);

while ( my $filename = shift @ARGV ) {
    my $html = read_file( $filename, binmode => ':utf8' );
    $html = decode_utf8 $html;
    binmode STDOUT, ':encoding(UTF-8)';
    my ( $pre, $body, $post ) = $html =~ m{^(.*<body>)(.*)(</body>.*)$}xmgis;
    ## no critic qw(RequireCheckedSyscalls)
    print $pre, $hyphenator->hyphenated($body), $post;
    ## use critic
}
